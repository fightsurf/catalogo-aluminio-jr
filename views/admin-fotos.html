<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Admin Fotos</title>
  <style>
    body { font-family: Arial, sans-serif; }
    .produto {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
    }
    input[type="text"] {
      width: 350px;
    }
    button {
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h2>Administração de Fotos</h2>

  <div id="lista"></div>

  <script>
    async function carregarProdutos() {
      const res = await fetch('/api/produtos');
      const produtos = await res.json();

      const lista = document.getElementById('lista');
      lista.innerHTML = '';

      produtos.forEach(p => {
        const div = document.createElement('div');
        div.className = 'produto';

        div.innerHTML = `
          <strong>${p.id}</strong>
          <span>${p.nome}</span>
          <input type="text" placeholder="URL da foto" value="${p.foto || ''}">
          <button>Salvar</button>
        `;

        const input = div.querySelector('input');
        const btn = div.querySelector('button');

        btn.onclick = async () => {
          await fetch('/admin-fotos-1234', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              id: p.id,
              foto: input.value
            })
          });
          btn.textContent = 'Salvo ✓';
          setTimeout(() => btn.textContent = 'Salvar', 1000);
        };

        lista.appendChild(div);
      });
    }

    carregarProdutos();
  </script>
</body>
</html>
